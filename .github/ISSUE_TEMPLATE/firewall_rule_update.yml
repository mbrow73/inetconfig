---                              # ← must start with frontmatter
name: "Firewall Rule Update Request"
description: "Update one existing firewall rule. For multiple updates, open this form multiple times."
labels:
  - firewall-update-request
---

body:                           # ← after the closing --- begins your form schema
  - type: input
    id: reqid
    attributes:
      label: "Request ID (REQID)"
      placeholder: "REQ12345"
      description: "REQ followed by digits"
    validations:
      required: true

  - type: input
    id: carid
    attributes:
      label: "CARID"
      placeholder: "APP1"
      description: "Your team/application ID"
    validations:
      required: true

  - type: input
    id: existing_rule_name
    attributes:
      label: "Existing Rule Name"
      placeholder: "AUTO-APP1-REQ12345-1-TCP-443"
      description: "Exact name of the rule to update"
    validations:
      required: true

  - type: input
    id: new_source_ips
    attributes:
      label: "New Source IP(s)/CIDR(s)"
      placeholder: "203.0.113.55/32"
      description: "Comma-separated if multiple"
    validations:
      required: true

  - type: input
    id: new_destination_ips
    attributes:
      label: "New Destination IP(s)/CIDR(s)"
      placeholder: "10.1.2.22/32"
    validations:
      required: true

  - type: input
    id: new_ports
    attributes:
      label: "New Port(s)"
      placeholder: "443"
      description: "Single, list (80,443), or range (1000-2000)"
    validations:
      required: true

  - type: dropdown
    id: new_protocol
    attributes:
      label: "Protocol"
      options: [tcp, udp, icmp]
    validations:
      required: true

  - type: dropdown
    id: new_direction
    attributes:
      label: "Direction"
      options: [INGRESS, EGRESS]
    validations:
      required: true

  - type: textarea
    id: new_justification
    attributes:
      label: "Business Justification"
      description: "Why is this change needed?"
    validations:
      required: true
